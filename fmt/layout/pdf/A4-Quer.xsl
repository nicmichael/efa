<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format"><xsl:variable name="seitenbreite" select="'297'"></xsl:variable><xsl:variable name="seitenhoehe" select="'210'"></xsl:variable><xsl:variable name="schriftgroesse">12</xsl:variable><xsl:variable name="rand">20</xsl:variable><xsl:variable name="_titel"></xsl:variable><xsl:template match="kilometerliste"><fo:root><fo:layout-master-set><fo:simple-page-master master-name="titelseite" page-width="{$seitenbreite}mm" page-height="{$seitenhoehe}mm"><fo:region-body margin-top="{$rand}mm" margin-bottom="{$rand}mm" margin-left="{$rand}mm" margin-right="{$rand}mm"></fo:region-body></fo:simple-page-master><fo:simple-page-master master-name="kmseite" page-width="{$seitenbreite}mm" page-height="{$seitenhoehe}mm"><fo:region-body margin-top="{$rand}mm" margin-bottom="{$rand}mm" margin-left="{$rand}mm" margin-right="{$rand}mm"></fo:region-body><fo:region-before extent="{$rand}mm"></fo:region-before><fo:region-after extent="{$rand}mm"></fo:region-after></fo:simple-page-master></fo:layout-master-set><fo:page-sequence master-reference="titelseite"><xsl:apply-templates select="listenkopf"></xsl:apply-templates></fo:page-sequence><fo:page-sequence master-reference="kmseite" initial-page-number="1"><fo:static-content flow-name="xsl-region-before" font-size="{$schriftgroesse}pt" font-family="Helvetica"><fo:list-block font-size="0.8em" space-before="{$rand div 2}mm" start-indent="{$rand}mm" end-indent="{$rand}mm"><fo:list-item><fo:list-item-label><fo:block><xsl:choose><xsl:when test="$_titel=''"><xsl:value-of select="listenkopf/titel"></xsl:value-of></xsl:when><xsl:otherwise><xsl:value-of select="$_titel"></xsl:value-of></xsl:otherwise></xsl:choose>  </fo:block></fo:list-item-label><fo:list-item-body><fo:block text-align="right"><xsl:value-of select="listenkopf/auswertungsProgramm"></xsl:value-of></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:static-content><fo:static-content flow-name="xsl-region-after" font-size="{$schriftgroesse}pt" font-family="Helvetica"><fo:list-block font-size="0.8em" space-after="{$rand div 3}mm" start-indent="{$rand}mm" end-indent="{$rand}mm"><fo:list-item><fo:list-item-label><fo:block>erstellt am <xsl:value-of select="listenkopf/auswertungsDatum"></xsl:value-of></fo:block></fo:list-item-label><fo:list-item-body><fo:block text-align="right">Seite <fo:page-number></fo:page-number></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:static-content><fo:flow flow-name="xsl-region-body" font-size="{$schriftgroesse}pt" font-family="Helvetica"><xsl:apply-templates select="tabelle"></xsl:apply-templates><xsl:apply-templates select="gruppe[1]"></xsl:apply-templates><xsl:apply-templates select="zusatzTabelle"></xsl:apply-templates><xsl:apply-templates select="spezialTabelle"></xsl:apply-templates></fo:flow></fo:page-sequence></fo:root></xsl:template><xsl:template match="listenkopf"><fo:flow flow-name="xsl-region-body" font-size="12pt" font-family="Helvetica"><fo:block font-size="24pt" text-align="center" space-before="1cm" space-after="3cm" border="3pt #000000 solid" padding-right="10mm" color="#000099" background-color="#bbbbff"> <xsl:choose><xsl:when test="$_titel=''"><xsl:value-of select="titel"></xsl:value-of></xsl:when><xsl:otherwise><xsl:value-of select="$_titel"></xsl:value-of></xsl:otherwise></xsl:choose>  </fo:block><fo:list-block font-size="12pt" space-before="1cm"><fo:list-item><fo:list-item-label><fo:block>erstellt am:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:value-of select="auswertungsDatum"></xsl:value-of></fo:block></fo:list-item-body></fo:list-item><fo:list-item><fo:list-item-label><fo:block>Art der Auswertung:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:value-of select="auswertungsArt"></xsl:value-of></fo:block></fo:list-item-body></fo:list-item><fo:list-item><fo:list-item-label><fo:block>Zeitraum:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:value-of select="auswertungsZeitraum"></xsl:value-of></fo:block></fo:list-item-body></fo:list-item><fo:list-item><fo:list-item-label><fo:block>Ausgewertete Einträge:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:value-of select="ausgewertet/ausgewerteteEintraege"></xsl:value-of></fo:block></fo:list-item-body></fo:list-item><fo:list-item><fo:list-item-label><fo:block>ausgewertet für:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:apply-templates select="ausgewertet/ausgewertetFuer"></xsl:apply-templates></fo:block></fo:list-item-body></fo:list-item><xsl:apply-templates select="ausgewertet/ausgewertetNurFuer"></xsl:apply-templates><xsl:apply-templates select="ausgewertet/ausgewertetWettNur"></xsl:apply-templates></fo:list-block><fo:block font-size="14pt" text-align="center" space-before="2cm">erstellt von <xsl:value-of select="auswertungsProgramm"></xsl:value-of></fo:block></fo:flow></xsl:template>  <xsl:template match="ausgewertetFuer"><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></xsl:template><xsl:template match="ausgewertetNurFuer"><fo:list-item><fo:list-item-label><fo:block>nur für <xsl:value-of select="@bezeichnung"></xsl:value-of>:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:list-item-body></fo:list-item></xsl:template><xsl:template match="ausgewertetWettNur"><fo:list-item><fo:list-item-label><fo:block>Ausgabe nur, wenn:</fo:block></fo:list-item-label><fo:list-item-body start-indent="50mm"><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:list-item-body></fo:list-item></xsl:template><xsl:template match="tabelle"><fo:table><xsl:variable name="_color0">#ccccff</xsl:variable><xsl:variable name="_color1">#eeeeff</xsl:variable><xsl:variable name="_color2">#ccccff</xsl:variable><xsl:for-each select="tabellenTitel/spaltenTitel"><fo:table-column column-width="{ ($seitenbreite - 2 * $rand) div count(../spaltenTitel) }mm"></fo:table-column></xsl:for-each><fo:table-body><fo:table-row background-color="{$_color0}"><xsl:for-each select="tabellenTitel/spaltenTitel"><fo:table-cell padding-right="6pt"><fo:block text-align="center" font-weight="bold"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:for-each></fo:table-row><xsl:for-each select="eintrag"><xsl:variable name="absnr"><xsl:value-of select="absnr"></xsl:value-of></xsl:variable>	  <xsl:variable name="color"><xsl:choose><xsl:when test="$absnr mod 2 = 0"><xsl:value-of select="$_color1"></xsl:value-of></xsl:when><xsl:when test="$absnr mod 2 = 1"><xsl:value-of select="$_color2"></xsl:value-of></xsl:when><xsl:otherwise><xsl:value-of select="$_color0"></xsl:value-of></xsl:otherwise></xsl:choose></xsl:variable><fo:table-row background-color="{$color}"><xsl:apply-templates select="nr"></xsl:apply-templates><xsl:apply-templates select="name"></xsl:apply-templates><xsl:apply-templates select="jahrgang"></xsl:apply-templates><xsl:apply-templates select="status"></xsl:apply-templates><xsl:apply-templates select="bezeichnung"></xsl:apply-templates><xsl:apply-templates select="km"></xsl:apply-templates><xsl:apply-templates select="rudkm"></xsl:apply-templates><xsl:apply-templates select="stmkm"></xsl:apply-templates><xsl:apply-templates select="fahrten"></xsl:apply-templates><xsl:apply-templates select="kmfahrt"></xsl:apply-templates><xsl:apply-templates select="dauer"></xsl:apply-templates><xsl:apply-templates select="kmh"></xsl:apply-templates><xsl:apply-templates select="anzversch"></xsl:apply-templates><xsl:apply-templates select="wafakm"></xsl:apply-templates><xsl:apply-templates select="zielfahrten"></xsl:apply-templates><xsl:apply-templates select="zusatzDRV"></xsl:apply-templates><xsl:apply-templates select="zusatzLRVBSommer"></xsl:apply-templates><xsl:apply-templates select="zusatzLRVBWinter"></xsl:apply-templates><xsl:apply-templates select="zusatzLRVBrbWanderWett"></xsl:apply-templates><xsl:apply-templates select="zusatzLRVBrbFahrtenWett"></xsl:apply-templates><xsl:apply-templates select="fahrtenbuch"></xsl:apply-templates><xsl:apply-templates select="wwListe"></xsl:apply-templates></fo:table-row></xsl:for-each></fo:table-body></fo:table></xsl:template>  <xsl:template match="nr"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="name"><fo:table-cell padding-right="6pt"><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="jahrgang"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="status"><fo:table-cell padding-right="6pt"><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="bezeichnung"><fo:table-cell padding-right="6pt"><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="km"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="rudkm"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="stmkm"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="fahrten"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="kmfahrt"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="dauer"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="kmh"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="anzversch"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="wafakm"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="zielfahrten"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="zusatzDRV"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="zusatzLRVBSommer"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="zusatzLRVBWinter"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="zusatzLRVBrbWanderWett"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="zusatzLRVBrbFahrtenWett"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:template><xsl:template match="fahrtenbuch"><xsl:for-each select="fbFeld"><fo:table-cell><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:for-each></xsl:template><xsl:template match="wwListe"><xsl:for-each select="wwFeld"><xsl:choose><xsl:when test="@selbst='true'"><fo:table-cell><fo:block background-color="#ffdddd"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:when><xsl:otherwise><fo:table-cell><fo:block><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:otherwise></xsl:choose></xsl:for-each></xsl:template><xsl:template match="gruppe"><fo:block font-size="20pt" text-align="center" space-before="5cm" border="3pt #000000 solid" padding-right="10mm" border-color="#ff0000"> Die Ausgabe der Wettbewerbe im PDF-Format ist im Stylesheet nocht nicht implementiert!</fo:block></xsl:template>  <xsl:template match="zusatzTabelle"><fo:table><xsl:for-each select="zusatzTabelleZeile/zusatzTabelleSpalte"><fo:table-column column-width="{ ($seitenbreite - 2 * $rand) div count(../zusatzTabelleSpalte) }mm"></fo:table-column></xsl:for-each><fo:table-body><xsl:for-each select="zusatzTabelleZeile"><fo:table-row><xsl:for-each select="zusatzTabelleSpalte"><fo:table-cell padding-right="6pt"><fo:block text-align="center"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:for-each></fo:table-row></xsl:for-each></fo:table-body></fo:table></xsl:template><xsl:template match="spezialTabelle"><xsl:apply-templates select="subTabelle"></xsl:apply-templates></xsl:template><xsl:template match="subTabelle"><fo:table padding-bottom="20pt"><xsl:choose><xsl:when test="@anzCols='7'"> <fo:table-column></fo:table-column><fo:table-column></fo:table-column><fo:table-column></fo:table-column></xsl:when></xsl:choose>    <fo:table-column></fo:table-column><fo:table-column></fo:table-column><fo:table-column></fo:table-column><fo:table-column></fo:table-column><fo:table-body><xsl:apply-templates select="zeile"></xsl:apply-templates></fo:table-body></fo:table></xsl:template><xsl:template match="zeile"><fo:table-row><xsl:apply-templates select="spalte"></xsl:apply-templates></fo:table-row></xsl:template><xsl:template match="spalte"><xsl:variable name="_align"><xsl:choose><xsl:when test="../@colspan='1'">left</xsl:when><xsl:otherwise>center</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="_bgcolor"><xsl:choose><xsl:when test="@color"><xsl:value-of select="@color"></xsl:value-of></xsl:when><xsl:otherwise>ffffff</xsl:otherwise></xsl:choose></xsl:variable><xsl:choose><xsl:when test="@bold='true'"><fo:table-cell number-columns-spanned="{../@colspan}"><fo:block font-weight="bold" text-align="{$_align}" background-color="#{$_bgcolor}"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:when><xsl:otherwise> <fo:table-cell number-columns-spanned="{../@colspan}"><fo:block text-align="{$_align}" background-color="#{$_bgcolor}"><xsl:value-of select="."></xsl:value-of></fo:block></fo:table-cell></xsl:otherwise></xsl:choose></xsl:template>





<!-- =================== Spezialtabelle =================== -->

  <xsl:template match="spezialTabelle">
    <xsl:apply-templates select="subTabelle"/>
  </xsl:template>

  <xsl:template match="subTabelle">
    <fo:table padding-bottom="20pt">
      <xsl:choose>
        <xsl:when test="@anzCols='7'"> <!-- schmutzig: funktioiert nur für Werte 4 und 7 -->
          <fo:table-column/>
          <fo:table-column/>
          <fo:table-column/>
	</xsl:when>
      </xsl:choose>    
      <fo:table-column/>
      <fo:table-column/>
      <fo:table-column/>
      <fo:table-column/>
      <fo:table-body>
        <xsl:apply-templates select="zeile"/>
      </fo:table-body>
    </fo:table>
  </xsl:template>

  <xsl:template match="zeile">
    <fo:table-row>
      <xsl:apply-templates select="spalte"/>
    </fo:table-row>
  </xsl:template>

  <xsl:template match="spalte">
    <xsl:variable name="_align">
      <xsl:choose>
        <xsl:when test="../@colspan='1'">left</xsl:when>
        <xsl:otherwise>center</xsl:otherwise>
      </xsl:choose>
    </xsl:variable>
    <xsl:variable name="_bgcolor">
      <xsl:choose>
        <xsl:when test="@color"><xsl:value-of select="@color"/></xsl:when>
        <xsl:otherwise>dddddd</xsl:otherwise>
      </xsl:choose>
    </xsl:variable>

    <xsl:choose>
      <xsl:when test="@bold='true'">
        <fo:table-cell number-columns-spanned="{../@colspan}"><fo:block font-weight="bold" text-align="{$_align}" background-color="#{$_bgcolor}"><xsl:value-of select="."/></fo:block></fo:table-cell>
      </xsl:when>
      <xsl:otherwise> 
        <fo:table-cell number-columns-spanned="{../@colspan}"><fo:block text-align="{$_align}" background-color="#{$_bgcolor}"><xsl:value-of select="."/></fo:block></fo:table-cell>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>


</xsl:stylesheet>
